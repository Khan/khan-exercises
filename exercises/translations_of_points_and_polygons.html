<!DOCTYPE html>
<html data-require="math graphie geom interactive">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Translating Polygons</title>
    <script src="../khan-exercise.js"></script>
</head>
<body>
<div class="exercise">
    <div class="problems">

        <div>
            <div class="vars">
                <var id="SX,SY,EX,EY" data-ensure="SX !== EX || SY !== EY">randRange(-4, 4, 4)</var>
                <var id="DX,DY">[EX - SX, EY - SY]</var>
                <var id="POINTS">_.map(_.range(6), function() {
                    return {x: randRange(-4, 4), y: randRange(-4, 4)};
                })</var>
                <var id="HULL">_.map(Geom.convexhull(POINTS), function(p) {
                    return [p.x + SX, p.y + SY];
                })</var>
                <var id="TARGET"> _.map(HULL, function(p) {
                    return [p[0] + DX, p[1] + DY];
                })</var>
            </div>

            <p class="question">
                What is the image of the polygon below after the translation <code>T_{(<var>DX</var>, <var>DY</var>)}</code>?
            </p>

            <div class="problem">
                <div class="graphie" id="grid">
                    graphInit({
                        range: 11,
                        scale: 20,
                        axisArrows: "&lt;-&gt;",
                        tickStep: 1,
                        labelStep: 1,
                        gridOpacity: 0.05,
                        axisOpacity: 0.2,
                        tickOpacity: 0.4,
                        labelOpacity: 0.5
                    });

                    //path(HULL, {stroke: BLUE});

                    for(var i=0; i &lt; HULL.length; i++){
                        line(HULL[i], HULL[(i+1) % HULL.length], { stroke: GRAY });
                    }

                    addMouseLayer();

                    graph.points = _.map(HULL, function(point){ return addMovablePoint({ coord: point, visible: false }); });
                    graph.lines = [];
                    for(var i=0; i &lt; graph.points.length; i++){
                        graph.lines.push(addMovableLineSegment({ pointA: graph.points[i], pointZ: graph.points[(i+1) % graph.points.length], snapX: 1, snapY: 1}));
                    }

                    graph.curPoints = _.map(graph.points, function(point){ return point.coord; });

                    _.each(graph.lines, function(line){ line.onMove = function(dX, dY){ graph.updatePolygon(dX, dY); }});

                    graph.updatePolygon = function(dX, dY){
                        _.each(graph.points, function(point){ point.setCoord([point.coord[0] + dX, point.coord[1] + dY]); point.updateLineEnds(); });
                        graph.curPoints = _.map(graph.points, function(point){ return point.coord; });
                    }

                    graph.showGuess = function(){
                        graph.points = _.map(graph.curPoints, function(point){ return addMovablePoint({ coord: point, visible: false }); });
                        graph.lines = [];
                        for(var i=0; i &lt; graph.points.length; i++){
                            graph.lines.push(addMovableLineSegment({ pointA: graph.points[i], pointZ: graph.points[(i+1) % graph.points.length], snapX: 1, snapY: 1}));
                        }
                    }

                    graph.drawAnswer = function(){
                        for(var i=0; i &lt; TARGET.length; i++){
                            line(TARGET[i], TARGET[(i+1) % TARGET.length], { stroke: ORANGE });
                        }
                    }
                </div>
            </div>

            <div class="solution" data-type="custom">
                <div class="instruction">
                    Drag the blue polygon to its image under the given translation.
                </div>
                <div class="guess"> KhanUtil.currentGraph.graph.curPoints
                </div>
                <div class="validator-function">
                    coordList = _.map(KhanUtil.currentGraph.graph.points, function(point){ return point.coord; });
                    return _.all(coordList, function(point){
                        return (point[0] === TARGET[_.indexOf(coordList, point)][0])
                            &amp;&amp; (point[1] === TARGET[_.indexOf(coordList, point)][1]);
                    });
                </div>
                <div class="show-guess">
                    KhanUtil.currentGraph.graph.curPoints = guess;
                    KhanUtil.currentGraph.graph.showGuess();
                </div>
            </div>

            <div class="hints">
                <p>
                    Translating a polygon slides it to somewhere else in the plane.
                </p>
                <p>
                    To find the image of a polygon under a translation, you have to add the value of the translation's x- and y-components to each 
                    point in that polygon.
                </p>
                <p>
                    For the translation <code>T_{(<var>DX</var>, <var>DY</var>)}</code>, you move the polygon <var> Math.abs(DX) </var>
                    units to the <var> DX &gt; 0 ? "right" : "left" </var> and <var> Math.abs(DY) </var> units <var> DY &gt; 0 ? "up" : "down" </var>.
                </p>
                <div>
                    The orange outline shows where the polygon ends up after the translation.
                    <div class="graphie" data-update="grid">
                        for(var i=0; i &lt; TARGET.length; i++){
                            line(TARGET[i], TARGET[(i+1) % TARGET.length], { stroke: ORANGE });
                        }
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>
</body>
</html>