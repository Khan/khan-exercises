<!DOCTYPE html>
<html data-require="math graphie">
<head>
	<title>Division 1.5</title>
	<script src="../khan-exercise.js"></script>
	<script>
		function drawDigits( digits, startX, startY, color ) {
			with ( jQuery.tmpl.VARS ) {
				with ( KhanUtil.currentGraph ) {
					var set = [];
					jQuery.each( digits, function( index, digit ) {
						var colorStrPre = color ? "\\color{" + color + "}{" : "";
						var colorStrPost = color ? "}" : "";
						var str = "\\Huge{" + colorStrPre + digit + colorStrPost+ "}";
						set.push( label( [ startX + index, startY ], str ) );
					});
					return set;
				}
			}
		}
	</script>
</head>
<body>
	<div class="exercise">
		<div class="vars">
			<var id="DIVISOR">randRange( 2, 9 )</var>
			<var id="NUM_DIGITS">randRange( 2, 3 )</var>
			<var id="MAX_QUOTIENT_DIGIT">floor( 9 / DIVISOR )</var>
			<var id="QUOTIENT">
				(function() {
					var quotient = randRange( 1, MAX_QUOTIENT_DIGIT );
					for ( var i = 1; i &lt; NUM_DIGITS; i++ ){
						quotient *= 10;
						quotient += randRange( 0, MAX_QUOTIENT_DIGIT );
					}
					return quotient;
				})()
			</var>
			<var id="Q_DIGITS">integerToDigits( QUOTIENT )</var>
			<var id="DIVIDEND">DIVISOR * QUOTIENT</var>
			<var id="DIVIDEND_DIGITS">integerToDigits( DIVIDEND )</var>
			<var id="DIVISOR_DIGITS">integerToDigits( DIVISOR )</var>
			<var id="HIGHLIGHTS">[]</var>
		</div>

		<div class="problems">
			<div>
				<div class="graphie" id="numbers">
					init({
						range: [ [ -2, DIVIDEND_DIGITS.length + 2 ], [ DIVIDEND_DIGITS.length * -2 - 1, 2 ] ],
						scale: [ 30, 45 ]
					});
					style({
						strokeWidth: 1
					});

					drawDigits( DIVISOR_DIGITS, -1.5, 0, true );
					drawDigits( DIVIDEND_DIGITS, 0, 0, true );
					path( [ [ -0.75, -0.5 ], [ -0.75, 0.5 ], [ DIVIDEND_DIGITS.length, 0.5 ] ] );
				</div>
				<div class="solution"><var>QUOTIENT</var></div>
			</div>
		</div>
		<div class="hints">
			<div data-each="DIVIDEND_DIGITS as index, value" data-unwrap>
				<div class="graphie" data-update="numbers">
					while ( HIGHLIGHTS.length ) {
						HIGHLIGHTS.pop().remove();
					}
					var index = <var>index</var>;
					var value = <var>value</var>;
					var quotient = value / DIVISOR;
					HIGHLIGHTS = HIGHLIGHTS.concat( drawDigits( [ value ], index, 0, "#6495ED" ) );
					if ( index !== 0 ) {
						style({
							arrows: "->"
						}, function(){
							HIGHLIGHTS.push( path( [ [ index, 0 - 0.5 ], [ index, -2 * index + 0.5 ]] ) );
						});
					}

					drawDigits( [ value ], index, -2 * index );
					HIGHLIGHTS = HIGHLIGHTS.concat( drawDigits( [ value ], index, -2 * index, "#6495ED" ) );

					label( [ DIVIDEND_DIGITS.length + 1, -2 * index ],
						"\\text{How many times does }"
						+ DIVISOR
						+ "\\text{ go into }"
						+ "\\color{#6495ED}{" + value + "}"
						+ "\\text{?}", "right" );
				</div>
				<div class="graphie" data-update="numbers">
					var index = <var>index</var>;
					var value = <var>value</var>;
					var quotient = value / DIVISOR;

					drawDigits( [ quotient ], index, 1 );
					HIGHLIGHTS = HIGHLIGHTS.concat( drawDigits( [ quotient ], index, 1, "#28AE7B" ) );

					drawDigits( [ DIVISOR * quotient ], index, -2 * index - 1 );
					HIGHLIGHTS = HIGHLIGHTS.concat( drawDigits( [ DIVISOR * quotient ], index, -2 * index - 1, "#FFA500" ) );

					drawDigits( [ value - DIVISOR * quotient ], index, -2 * index - 2)
					label( [ index - 1, -2 * index - 1 ] ,"-\\vphantom{0}" );
					path( [ [ index - 1.25, -2 * index - 1.5 ], [ index + 0.5, -2 * index - 1.5 ] ] );

					label( [ DIVIDEND_DIGITS.length + 1, -2 * index - 1 ],
						"\\color{#6495ED}{" + value + "}"
						+ "\\div"
						+ DIVISOR + "="
						+ "\\color{#28AE7B}{" + quotient + "}"
						+ "\\text{ or }"
						+ DIVISOR
						+ "\\times"
						+ "\\color{#28AE7B}{" + quotient + "}"
						+ " = "
						+ "\\color{#FFA500}{" + value + "}", "right" );
				</div>
			</div>

			<div class="graphie" data-update="numbers">
					while( HIGHLIGHTS.length ) {
						HIGHLIGHTS.pop().remove();
					}
			</div>
		</div>
	</div>
</body>
</html>
